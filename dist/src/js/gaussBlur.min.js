(function($,root){"use strict";function gaussBlur(imgData){var pixes=imgData.data;var width=imgData.width;var height=imgData.height;var gaussMatrix=[],gaussSum=0,x,y,r,g,b,a,i,j,k,len;var radius=10;var sigma=5;a=1/(Math.sqrt(2*Math.PI)*sigma);b=-1/(2*sigma*sigma);for(i=0,x=-radius;x<=radius;x++,i++){g=a*Math.exp(b*x*x);gaussMatrix[i]=g;gaussSum+=g}for(i=0,len=gaussMatrix.length;i<len;i++){gaussMatrix[i]/=gaussSum}for(y=0;y<height;y++){for(x=0;x<width;x++){r=g=b=a=0;gaussSum=0;for(j=-radius;j<=radius;j++){k=x+j;if(k>=0&&k<width){i=(y*width+k)*4;r+=pixes[i]*gaussMatrix[j+radius];g+=pixes[i+1]*gaussMatrix[j+radius];b+=pixes[i+2]*gaussMatrix[j+radius];gaussSum+=gaussMatrix[j+radius]}}i=(y*width+x)*4;pixes[i]=r/gaussSum;pixes[i+1]=g/gaussSum;pixes[i+2]=b/gaussSum}}for(x=0;x<width;x++){for(y=0;y<height;y++){r=g=b=a=0;gaussSum=0;for(j=-radius;j<=radius;j++){k=y+j;if(k>=0&&k<height){i=(k*width+x)*4;r+=pixes[i]*gaussMatrix[j+radius];g+=pixes[i+1]*gaussMatrix[j+radius];b+=pixes[i+2]*gaussMatrix[j+radius];gaussSum+=gaussMatrix[j+radius]}}i=(y*width+x)*4;pixes[i]=r/gaussSum;pixes[i+1]=g/gaussSum;pixes[i+2]=b/gaussSum}}return imgData}function blurImg(img,ele){var w=img.width,h=img.height,canvasW=40,canvasH=40;var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=canvasW;canvas.height=canvasH;ctx.drawImage(img,0,0,w,h,0,0,canvasW,canvasH);var pixel=ctx.getImageData(0,0,canvasH,canvasH);gaussBlur(pixel);ctx.putImageData(pixel,0,0);var imageData=canvas.toDataURL();ele.css("background-image","url("+imageData+")")}root.blurImg=blurImg})(window.Zepto,window.player||(window.player={}));